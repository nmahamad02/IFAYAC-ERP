<div class="container-fluid">
    <div class="row no-gutters">
        <div class="visualization-heading col-12">
            <div class="heading-info">
                <div class="row">
                    <div class="col-8">
                        <h2 class="heading-title">Revenue Reports</h2>
                    </div>
                </div>
            </div>
            <hr>
            <div class="row">
                <div class="col-12">
                    <mat-card class="bg-secondary">
                        <mat-card-content>
                            <div class="row">
                                <div class="col-4">  
                                    <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
                                        <li class="nav-item active">
                                            <a class="nav-link" (click)="openLOCMOS()">Location-wise Monthly Sales</a>
                                        </li>
                                        <li class="nav-item active">
                                            <a class="nav-link" (click)="openIWPDSL()">Item-wise Period Sales</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="col-4">  
                                    <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
                                        <li class="nav-item active">
                                            <a class="nav-link" (click)="openMOSSUM()">Monthwise Sales Summary</a>
                                        </li>
                                        <li class="nav-item active">
                                            <a class="nav-link" (click)="openIWPDCS()">Item-wise Period Cost of Sales</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="col-4">  
                                    <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
                                        <li class="nav-item active">
                                            <a class="nav-link" (click)="openVWPDPF()">Voucher-wise Period Profit</a>
                                        </li>
                                        <li class="nav-item active">
                                            <a class="nav-link" (click)="openIWPDPF()">Item-wise Period Profit</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </mat-card-content>
                    </mat-card>
                </div>
            </div>
        </div>
    </div>
</div>

<ng-template #locmosLookupDialog>
    <h3 matDialogTitle>
        <b>Location-wise Monthly Sales Preview</b>
    </h3>
    <hr>
    <div mat-dialog-content style="font-size: small;">
        <div class="col-12">
            <div class="row">
                <div class="col-9">
                    <select [(ngModel)]="selectedLocation" class="form-control form-control-sm">
                        <option value="NULL">--- All Locations ---</option>
                        <option *ngFor="let loc of locationList" [value]="loc.locationCode">
                            {{ loc.locationName }}
                        </option>
                    </select>                    
                </div>
                <div class="col-3">
                    <button class="btn btn-sm btn-primary" (click)="getLOCMOS(selectedLocation)" >Filter</button>
                </div>
            </div>
            <br>
            <div class="row" *ngIf="locGroupedData.length === 0 && getData === true">
                <div class="col-4"></div>
                <div class="col-4">
                    <mat-spinner></mat-spinner>
                </div>
                <div class="col-4"></div>
            </div>
            <table class="table table-striped table-sm table-bordered" id="locMosTable">
                <thead class="table-dark">
                    <tr>
                        <th>Month</th>
                        <th colspan="2">Location</th>
                        <th>Amount</th>
                    </tr>
                </thead>
                <tbody>
                    <ng-container *ngFor="let group of locGroupedData">
                        <tr *ngFor="let row of group.rows">
                            <td>{{ row.MonthYear }}</td>
                            <td>{{ row.SALESUNITID }}</td>
                            <td>{{ row.LOCATIONNAME }}</td>
                            <td class="text-end">{{ row.Sales_KWD | number:'1.3-3' }}</td>
                        </tr>
                        <!-- Subtotal row per location -->
                        <tr class="fw-bold bg-light">
                            <td colspan="3" class="text-end">{{ group.location }} Subtotal</td>
                            <td class="text-end">{{ group.subtotal | number:'1.3-3' }}</td>
                        </tr>
                    </ng-container>
                </tbody>
                <tfoot>
                    <tr class="fw-bold text-end table-secondary">
                        <td colspan="3">Grand Total</td>
                        <td>{{ grandTotal | number:'1.3-3' }}</td>
                    </tr>
                </tfoot>
            </table>
        </div>
        <br>
    </div>
    <hr>
    <div class="row container-fluid">
        <div class="col-4"></div>
        <div class="col-4">
            <button mat-raised-button class="bg-warning text-black btn btn-block" (click)="exportLOCMOS()" style="float: right" title="export">
                Export to Excel
            </button>
        </div>
        <div class="col-4">
            <button mat-raised-button class="bg-success text-white btn btn-block" (click)="printLOCMOS()" style="float: right" title="print">
                Print Statement
            </button>
        </div>
    </div>
    <br>
</ng-template>

<ng-template #mossumLookupDialog>
    <h3 matDialogTitle>
        <b>Month-wise Sales Summary Preview</b>
    </h3>
    <hr>
    <div mat-dialog-content style="font-size: small;">
        <div class="row" *ngIf="mossumData.length === 0 && getData === true">
            <div class="col-4"></div>
            <div class="col-4">
                <mat-spinner></mat-spinner>
            </div>
            <div class="col-4"></div>
        </div>
        <div class="col-12">
            <table class="table table-striped table-sm table-bordered" id="mosSumTable">
                <thead class="table-dark">
                    <tr>
                        <th>Location</th>
                        <th>January</th>
                        <th>February</th>
                        <th>March</th>
                        <th>April</th>
                        <th>May</th>
                        <th>June</th>
                        <th>July</th>
                        <th>August</th>
                        <th>September</th>
                        <th>October</th>
                        <th>November</th>
                        <th>December</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let row of mossumData">
                        <td>{{ row.LOCATIONNAME }}</td>
                        <td class="text-end">{{ row.January | number:'1.3-3' }}</td>
                        <td class="text-end">{{ row.February | number:'1.3-3' }}</td>
                        <td class="text-end">{{ row.March | number:'1.3-3' }}</td>
                        <td class="text-end">{{ row.April | number:'1.3-3' }}</td>
                        <td class="text-end">{{ row.May | number:'1.3-3' }}</td>
                        <td class="text-end">{{ row.June | number:'1.3-3' }}</td>
                        <td class="text-end">{{ row.July | number:'1.3-3' }}</td>
                        <td class="text-end">{{ row.August | number:'1.3-3' }}</td>
                        <td class="text-end">{{ row.September | number:'1.3-3' }}</td>
                        <td class="text-end">{{ row.October | number:'1.3-3' }}</td>
                        <td class="text-end">{{ row.November | number:'1.3-3' }}</td>
                        <td class="text-end">{{ row.December | number:'1.3-3' }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <br>
    </div>
    <hr>
    <div class="row container-fluid">
        <div class="col-4"></div>
        <div class="col-4">
            <button mat-raised-button class="bg-warning text-black btn btn-block" (click)="exportMOSSUM()" style="float: right" title="export">
                Export to Excel
            </button>
        </div>
        <div class="col-4">
            <button mat-raised-button class="bg-success text-white btn btn-block" (click)="printMOSSUM()" style="float: right" title="print">
                Print Statement
            </button>
        </div>
    </div>
    <br>
</ng-template>

<ng-template #iwpdslLookupDialog style="width: 100%;">
    <h3 matDialogTitle>
        <b>Item-wise Period Sales Preview</b>
    </h3>
    <hr>
    <div mat-dialog-content style="font-size: small;">
        <div class="col-12">
            <div class="row">
                <div class="col-4">
                    <div class="mb-3">
                        <input type="text" [(ngModel)]="selectedCustomer" class="form-control" placeholder="Search customers..." (keydown)="searchCustomer(selectedCustomer)" />
                    </div>
                    <table class="table table-hover table-responsive-xxl">
                        <thead class="table-dark">
                            <tr class="table-reflow">
                                <th>CODE</th>
                                <th>NAME</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let cust of customerList; let i = index;" (click)="selectCustomer(cust.CUSTOMERID)">
                                <td>{{ cust.CUSTOMERID }}</td>
                                <td>{{ cust.CUSTOMERNAME }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="col-8">
                    <div class="row">
                        <div class="col-4">
                            <select [(ngModel)]="selectedLocation" class="form-control form-control-sm">
                                <option value="NULL">--- All Locations ---</option>
                                <option *ngFor="let loc of locationList" [value]="loc.locationCode">
                                    {{ loc.locationName }}
                                </option>
                            </select>                    
                        </div>
                        <div class="col-3">
                            <input type="date" class="form-control form-control-sm" [(ngModel)]="startDate" placeholder="Start Date">
                        </div>
                        <div class="col-3">
                            <input type="date" class="form-control form-control-sm" [(ngModel)]="endDate" placeholder="End Date">
                        </div>
                        <div class="col-2">
                            <button class="btn btn-sm btn-primary" (click)="getIWPDSL()" >Filter</button>
                        </div>
                    </div>
                    <br>
                    <div class="row" *ngIf="groupedData.length === 0 && getData === true">
                        <div class="col-4"></div>
                        <div class="col-4">
                            <mat-spinner></mat-spinner>
                        </div>
                        <div class="col-4"></div>
                    </div>
                    <table class="table table-striped table-sm table-bordered" id="iwpdslTable">
                        <thead class="table-dark">
                            <tr>
                                <th>Voucher Number</th>
                                <th>Date</th>
                                <th>Customer ID</th>
                                <th>Customer Name</th>
                                <th>Location</th>
                                <th>Product ID</th>
                                <th>Product Name</th>
                                <th>Brand</th>
                                <th>Supplier</th>
                                <th>Unit</th>
                                <th>Unit Price</th>
                                <th>Quantity</th>
                                <th>Gross Amount</th>
                            </tr>
                        </thead>
                        <tbody>
                            <ng-container *ngFor="let group of groupedData">
                                <tr *ngFor="let row of group.rows">
                                    <td>{{ group.docNumber }}</td>
                                    <td>{{ row.DOCDATE | date:'dd-MMM-yyyy' }}</td>
                                    <td>{{ group.customerId }}</td>
                                    <td>{{ group.customerName }}</td>
                                    <td>{{ row.LOCATIONNAME }}</td>
                                    <td>{{ row.PRODUCTID }}</td>
                                    <td>{{ row.material_name }}</td>
                                    <td>{{ row.brand }}</td>
                                    <td>{{ row.supplier }}</td>
                                    <td>PCS</td>
                                    <td class="text-end">{{ row.UnitPrice | number:'1.3-3' }}</td>
                                    <td class="text-end">{{ row.UNITQTY | number:'1.0-0' }}</td>
                                    <td class="text-end">{{ row.GROSSAMOUNT | number:'1.3-3' }}</td>
                                </tr>
                                <!-- Subtotal row per document/customer -->
                                <tr class="fw-bold bg-light">
                                    <td colspan="12" class="text-end">
                                        Voucher {{ group.docNumber }} Subtotal
                                    </td>
                                    <td class="text-end">{{ group.subtotal | number:'1.3-3' }}</td>
                                </tr>
                            </ng-container>
                        </tbody>
                        <!---<tfoot>
                            <tr class="fw-bold text-end table-secondary">
                                <td colspan="12">Grand Total</td>
                                <td>{{ grandTotal | number:'1.3-3' }}</td>
                            </tr>
                        </tfoot>-->
                    </table>
                </div>
            </div>
            <br>
        </div>
    </div>
    <hr>
    <div class="row container-fluid">
        <div class="col-4"></div>
        <div class="col-4">
            <button mat-raised-button class="bg-warning text-black btn btn-block" (click)="exportIWPDSL()" style="float: right" title="export">
                Export to Excel
            </button>
        </div>
        <div class="col-4">
            <button mat-raised-button class="bg-success text-white btn btn-block" (click)="printIWPDSL()" style="float: right" title="print">
                Print Statement
            </button>
        </div>
    </div>
    <br>
</ng-template>

<ng-template #iwpdcsLookupDialog style="width: 100%;">
    <h3 matDialogTitle>
        <b>Item-wise Period Cost of Sales Preview</b>
    </h3>
    <hr>
    <div mat-dialog-content style="font-size: small;">
        <div class="col-12">
            <div class="row">
                <div class="col-4">
                    <div class="mb-3">
                        <input type="text" [(ngModel)]="selectedCustomer" class="form-control" placeholder="Search customers..." (keydown)="searchCustomer(selectedCustomer)" />
                    </div>
                    <table class="table table-hover table-responsive-xxl">
                        <thead class="table-dark">
                            <tr class="table-reflow">
                                <th>CODE</th>
                                <th>NAME</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let cust of customerList; let i = index;" (click)="selectCustomer(cust.CUSTOMERID)">
                                <td>{{ cust.CUSTOMERID }}</td>
                                <td>{{ cust.CUSTOMERNAME }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="col-8">
                    <div class="row">
                        <div class="col-4">
                            <select [(ngModel)]="selectedLocation" class="form-control form-control-sm">
                                <option value="NULL">--- All Locations ---</option>
                                <option *ngFor="let loc of locationList" [value]="loc.locationCode">
                                    {{ loc.locationName }}
                                </option>
                            </select>                    
                        </div>
                        <div class="col-3">
                            <input type="date" class="form-control form-control-sm" [(ngModel)]="startDate" placeholder="Start Date">
                        </div>
                        <div class="col-3">
                            <input type="date" class="form-control form-control-sm" [(ngModel)]="endDate" placeholder="End Date">
                        </div>
                        <div class="col-2">
                            <button class="btn btn-sm btn-primary" (click)="getIWPDCS()" >Filter</button>
                        </div>
                    </div>
                    <br>
                    <div class="row" *ngIf="groupedData.length === 0 && getData === true">
                        <div class="col-4"></div>
                        <div class="col-4">
                            <mat-spinner></mat-spinner>
                        </div>
                        <div class="col-4"></div>
                    </div>
                    <table class="table table-striped table-sm table-bordered" id="iwpdcsTable">
                        <thead class="table-dark">
                            <tr>
                                <th>Voucher Number</th>
                                <th>Date</th>
                                <th>Customer ID</th>
                                <th>Customer Name</th>
                                <th>Location</th>
                                <th>Product ID</th>
                                <th>Product Name</th>
                                <th>Brand</th>
                                <th>Supplier</th>
                                <th>Unit</th>
                                <th>Unit Cost</th>
                                <th>Quantity</th>
                                <th>Cost of Sale</th>
                            </tr>
                        </thead>
                        <tbody>
                            <ng-container *ngFor="let group of groupedData">
                                <tr *ngFor="let row of group.rows">
                                    <td>{{ group.docNumber }}</td>
                                    <td>{{ row.DOCDATE | date:'dd-MMM-yyyy' }}</td>
                                    <td>{{ group.customerId }}</td>
                                    <td>{{ group.customerName }}</td>
                                    <td>{{ row.LOCATIONNAME }}</td>
                                    <td>{{ row.PRODUCTID }}</td>
                                    <td>{{ row.material_name }}</td>
                                    <td>{{ row.brand }}</td>
                                    <td>{{ row.supplier }}</td>
                                    <td>PCS</td>
                                    <td class="text-end">{{ row.COSTAMOUNT | number:'1.3-3' }}</td>
                                    <td class="text-end">{{ row.UNITQTY | number:'1.0' }}</td>
                                    <td class="text-end">{{ row.CostOfSale | number:'1.3-3' }}</td>
                                </tr>
                                <!-- Subtotal row per document/customer -->
                                <tr class="fw-bold bg-light">
                                    <td colspan="12" class="text-end">
                                        Voucher {{ group.docNumber }} Subtotal
                                    </td>
                                    <td class="text-end">{{ group.subtotal | number:'1.3-3' }}</td>
                                </tr>
                            </ng-container>
                        </tbody>
                       <!---- <tfoot>
                            <tr class="fw-bold text-end table-secondary">
                                <td colspan="12">Grand Total</td>
                                <td>{{ grandTotal | number:'1.3-3' }}</td>
                            </tr>
                        </tfoot>-->
                    </table>
                </div>
            </div>
            <br>
        </div>
    </div>
    <hr>
    <div class="row container-fluid">
        <div class="col-4"></div>
        <div class="col-4">
            <button mat-raised-button class="bg-warning text-black btn btn-block" (click)="exportIWPDCS()" style="float: right" title="export">
                Export to Excel
            </button>
        </div>
        <div class="col-4">
            <button mat-raised-button class="bg-success text-white btn btn-block" (click)="printIWPDCS()" style="float: right" title="print">
                Print Statement
            </button>
        </div>
    </div>
    <br>
</ng-template>

<ng-template #iwpdpfLookupDialog style="width: 100%;">
    <h3 matDialogTitle>
        <b>Item-wise Period Profit Preview</b>
    </h3>
    <hr>
    <div mat-dialog-content style="font-size: small;">
        <div class="col-12">
            <div class="row">
                <div class="col-4">
                    <div class="mb-3">
                        <input type="text" [(ngModel)]="selectedCustomer" class="form-control" placeholder="Search customers..." (keydown)="searchCustomer(selectedCustomer)" />
                    </div>
                    <table class="table table-hover table-responsive-xxl">
                        <thead class="table-dark">
                            <tr class="table-reflow">
                                <th>CODE</th>
                                <th>NAME</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let cust of customerList; let i = index;" (click)="selectCustomer(cust.CUSTOMERID)">
                                <td>{{ cust.CUSTOMERID }}</td>
                                <td>{{ cust.CUSTOMERNAME }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="col-8">
                    <div class="row">
                        <div class="col-4">
                            <select [(ngModel)]="selectedLocation" class="form-control form-control-sm">
                                <option value="NULL">--- All Locations ---</option>
                                <option *ngFor="let loc of locationList" [value]="loc.locationCode">
                                    {{ loc.locationName }}
                                </option>
                            </select>                    
                        </div>
                        <div class="col-3">
                            <input type="date" class="form-control form-control-sm" [(ngModel)]="startDate" placeholder="Start Date">
                        </div>
                        <div class="col-3">
                            <input type="date" class="form-control form-control-sm" [(ngModel)]="endDate" placeholder="End Date">
                        </div>
                        <div class="col-2">
                            <button class="btn btn-sm btn-primary" (click)="getIWPDPF()" >Filter</button>
                        </div>
                    </div>
                    <br>
                    <div class="row" *ngIf="groupedData.length === 0 && getData === true">
                        <div class="col-4"></div>
                        <div class="col-4">
                            <mat-spinner></mat-spinner>
                        </div>
                        <div class="col-4"></div>
                    </div>
                    <table class="table table-striped table-sm table-bordered" id="iwpdpfTable">
                        <thead class="table-dark">
                            <tr>
                                <th>Voucher Number</th>
                                <th>Date</th>
                                <th>Customer ID</th>
                                <th>Customer Name</th>
                                <th>Location</th>
                                <th>Product ID</th>
                                <th>Product Name</th>
                                <th>Brand</th>
                                <th>Supplier</th>
                                <th>Unit</th>
                                <th>Unit Price</th>
                                <th>Unit Cost</th>
                                <th>Quantity</th>
                                <th>Cost of Sale</th>
                                <th>Gross Amount</th>
                                <th>Gross Profit</th>
                                <th>Profit Margin</th>
                            </tr>
                        </thead>
                        <tbody>
                            <ng-container *ngFor="let group of groupedData">
                                <tr *ngFor="let row of group.rows">
                                    <td>{{ group.docNumber }}</td>
                                    <td>{{ row.DOCDATE | date:'dd-MMM-yyyy' }}</td>
                                    <td>{{ group.customerId }}</td>
                                    <td>{{ group.customerName }}</td>
                                    <td>{{ row.LOCATIONNAME }}</td>
                                    <td>{{ row.PRODUCTID }}</td>
                                    <td>{{ row.material_name }}</td>
                                    <td>{{ row.brand }}</td>
                                    <td>{{ row.supplier }}</td>
                                    <td>PCS</td>
                                    <td class="text-end">{{ row.UnitPrice | number:'1.3-3' }}</td>
                                    <td class="text-end">{{ row.COSTAMOUNT | number:'1.3-3' }}</td>
                                    <td class="text-end">{{ row.UNITQTY | number:'1.0-0' }}</td>
                                    <td class="text-end">{{ row.CostOfSale | number:'1.3-3' }}</td>
                                    <td class="text-end">{{ row.GROSSAMOUNT | number:'1.3-3' }}</td>
                                    <td class="text-end">{{ row.GrossProfit | number:'1.3-3' }}</td>
                                    <td class="text-end">{{ row.ProfitPercent | number:'1.0-0' }}%</td>
                                </tr>
                                <!-- Subtotal row per document/customer -->
                                <tr class="fw-bold bg-light">
                                    <td colspan="9" class="text-end">
                                        Voucher {{ group.docNumber }} Subtotal
                                    </td>
                                    <td>Total Cost</td>
                                    <td class="text-end">{{ group.totalCost | number:'1.3-3' }}</td>
                                    <td>Total Sale</td>
                                    <td class="text-end">{{ group.totalSale | number:'1.3-3' }}</td>
                                    <td>Total Profit</td>
                                    <td class="text-end">{{ (group.totalSale-group.totalCost) | number:'1.3-3' }}</td>
                                    <td>Total Profit Margin</td>
                                    <td class="text-end">{{ ((group.totalSale-group.totalCost)/group.totalCost)*100 | number:'1.0-0' }}%</td>
                                </tr>
                            </ng-container>
                        </tbody>
                       <!--- <tfoot>
                            <tr class="fw-bold text-end table-secondary">
                                <td colspan="16">Grand Total</td>
                                <td>{{ grandTotal | number:'1.3-3' }}</td>
                            </tr>
                        </tfoot>-->
                    </table>
                </div>
            </div>
            <br>
        </div>
    </div>
    <hr>
    <div class="row container-fluid">
        <div class="col-4"></div>
        <div class="col-4">
            <button mat-raised-button class="bg-warning text-black btn btn-block" (click)="exportIWPDPF()" style="float: right" title="export">
                Export to Excel
            </button>
        </div>
        <div class="col-4">
            <button mat-raised-button class="bg-success text-white btn btn-block" (click)="printIWPDPF()" style="float: right" title="print">
                Print Statement
            </button>
        </div>
    </div>
    <br>
</ng-template>

<ng-template #vwpdpfLookupDialog style="width: 100%;">
    <h3 matDialogTitle>
        <b>Voucher-wise Period Profit Preview</b>
    </h3>
    <hr>
    <div mat-dialog-content style="font-size: small;">
        <div class="col-12">
            <div class="row">
                <div class="col-4">
                    <div class="mb-3">
                        <input type="text" [(ngModel)]="selectedCustomer" class="form-control" placeholder="Search customers..." (keydown)="searchCustomer(selectedCustomer)" />
                    </div>
                    <table class="table table-hover table-responsive-xxl">
                        <thead class="table-dark">
                            <tr class="table-reflow">
                                <th>CODE</th>
                                <th>NAME</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let cust of customerList; let i = index;" (click)="selectCustomer(cust.CUSTOMERID)">
                                <td>{{ cust.CUSTOMERID }}</td>
                                <td>{{ cust.CUSTOMERNAME }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="col-8">
                    <div class="row">
                        <div class="col-4">
                            <select [(ngModel)]="selectedLocation" class="form-control form-control-sm">
                                <option value="NULL">--- All Locations ---</option>
                                <option *ngFor="let loc of locationList" [value]="loc.locationCode">
                                    {{ loc.locationName }}
                                </option>
                            </select>                    
                        </div>
                        <div class="col-3">
                            <input type="date" class="form-control form-control-sm" [(ngModel)]="startDate" placeholder="Start Date">
                        </div>
                        <div class="col-3">
                            <input type="date" class="form-control form-control-sm" [(ngModel)]="endDate" placeholder="End Date">
                        </div>
                        <div class="col-2">
                            <button class="btn btn-sm btn-primary" (click)="getVWPDPF()" >Filter</button>
                        </div>
                    </div>
                    <br>
                    <div class="row" *ngIf="groupedData.length === 0 && getData === true">
                        <div class="col-4"></div>
                        <div class="col-4">
                            <mat-spinner></mat-spinner>
                        </div>
                        <div class="col-4"></div>
                    </div>
                    <table class="table table-striped table-sm table-bordered" id="vwpdpfTable">
                        <thead class="table-dark">
                            <tr>
                                <th>Voucher Number</th>
                                <th>Date</th>
                                <th>Customer ID</th>
                                <th>Customer Name</th>
                                <th>Location</th>
                                <th>Total Quantity</th>
                                <th>Total Cost of Sale</th>
                                <th>Gross Amount</th>
                                <th>Gross Profit</th>
                                <th>Profit Margin</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let row of vwpdpfData">
                                <td>{{ row.DOCNUMBER }}</td>
                                <td>{{ row.DOCDATE | date:'dd-MMM-yyyy' }}</td>
                                <td>{{ row.CUSTOMERID }}</td>
                                <td>{{ row.CUSTOMERNAME }}</td>
                                <td>{{ row.LOCATIONNAME }}</td>
                                <td class="text-end">{{ row.TotalQty | number:'1.0-0' }}</td>
                                <td class="text-end">{{ row.TotalCostOfSale | number:'1.3-3' }}</td>
                                <td class="text-end">{{ row.TotalGrossAmount | number:'1.3-3' }}</td>
                                <td class="text-end">{{ row.GrossProfit | number:'1.3-3' }}</td>
                                <td class="text-end">{{ row.ProfitPercent | number:'1.0-0' }}%</td>
                            </tr>
                        </tbody>
                       <!---- <tfoot>
                            <tr class="fw-bold text-end table-secondary">
                                <td colspan="9">Grand Total</td>
                                <td>{{ grandTotal | number:'1.3-3' }}</td>
                            </tr>
                        </tfoot>-->
                    </table>
                </div>
            </div>
            <br>
        </div>
    </div>
    <hr>
    <div class="row container-fluid">
        <div class="col-4"></div>
        <div class="col-4">
            <button mat-raised-button class="bg-warning text-black btn btn-block" (click)="exportVWPDPF()" style="float: right" title="export">
                Export to Excel
            </button>
        </div>
        <div class="col-4">
            <button mat-raised-button class="bg-success text-white btn btn-block" (click)="printVWPDPF()" style="float: right" title="print">
                Print Statement
            </button>
        </div>
    </div>
    <br>
</ng-template>